# Board 支持的可参考文档



## 板卡芯片熟悉和初试

- 拿到一块心仪的 riscv 的板卡后，我们要做的第一件事情当然是**尽自己所能玩弄你的板卡**，我一般的流程是如下的：
  - check 板卡的硬件架构，硬件资源，整体软件生态支持情况，一些网上的性能测评，开箱测评，以及厂家的上游活跃度，开发者社区等资源 【这个应该是在下单前就要考虑的】
  - 通过漫长的等待，你迎来了你的板卡，迫不及待的点开早已下载好的软件SDK 或者操作系统镜像，烧到板卡里面。【一般来说,SDK 相比可以直接烧的镜像来说更硬核一些，我们要做 uniproton board support 肯定是比仅仅用sdk 更硬核的】
  - 跑起操作系统后，你开始捣鼓官方给的各个测试案例，或者性能跑分案例，你对自己买到的板卡觉得倍感欣慰，不亏【MCU 一般是直接上SDK, 跑官方点灯例程 或者 应用开发例程，跑一些应用】
  - 接下来，你需要更进一步，我们需要更硬核的知识了
    - 软件，你需要玩一玩官方的SDK，了解基本出镜像的流程，当然，能力足够的话需要阅读对应的构建脚本，收集资料是很重要的，脑子里需要记住所有官方支持的资料，社区的伙伴的一些资料。
    - 硬件，去手机所有与板卡相关的资料，包括板卡原理图等。一般来说，你直接买的应该是 SOC , 分为的外设 + 核心 ，对于核心，你需要了解他的型号，然后去收集核心的资料，包括一些datasheet等。
  - 尝试修改 sdk 的案例代码，根据自己的开发经验，搞一些有趣的开发 或者 去查阅其他开发者的玩具，复线社区其他开发者的玩具
- 基本玩的差不多的情况，你可以这样来判定你是否可以开启下一步
  - 是否知道构建系统的构建执行流
  - 是否能够自己写一些可玩的小demo
  - 手上的资料是否能够涵盖完整个芯片



## 阅读芯片手册，理解启动流程

- 对 操作系统移植者 来说，最重要的就是**芯片启动流程** 和 **CPU地址空间分布**了， 一个和构建系统出镜像息息相关，另一个和软件对应的硬件驱动息息相关
- 在这个阶段，你需要 【PS: 如果是零基础的朋友，更加推荐的是先进行一个具体的板卡的学习】
  - 理解芯片启动流程，也就是sdk 里面出镜像的第一部分执行的内容
  - 理解芯片所拥有的硬件资源所在的地址空间
  - 理解 sdk 镜像的编译流程
- 操作系统的移植，需要开发者具备足够的体系结构的知识和丰富的软件脚本以及开发的知识，如果在过程中遇到任何困难，及时考虑补充知识！



## 一切准备就绪，开始干活

- 一般来说，某个厂商的 sdk 是会有对应的 rtos 适配的，比如一些常见的 mcu 会有 freertos 的适配
- 经历了前两个步骤的洗刷，你已经对软硬件环境有了基础的认识，要开始做正式的板卡移植了！
  - 根据芯片启动流程和厂商sdk 的软件，一般性的来说，会有一个 bootloader 的阶段，bootloader
    - 常规的厂家的 bootloader 能够识别某种格式的bin ，你需要在后续把 uniproton 镜像包装成对应的bin格式 
    - 如果厂家的sdk 可以包装，那么你需要利用厂家sdk进行包装
  - 修改完bootloader相关的内容后，你成功的能够将整个 rtos 引导到 内存里面，并跳转到 os 第一行代码，然后你需要，修改 plic 和 clint 中断控制器相关的配置，把中断异常和trap 等管理代理给 uniproton
  - 完成上述操作后，可以运行kernel 测试案例了，运行 测试案例，确保所有的kernel 测试案例通过
  - 接下来又是一个大头部分，平替所有其他rtos 的驱动
    - 把所有在其他rtos实现的驱动使用的kernel api 替换成 uniproton 的 api 【这个没有太多指导性意见，根据厂商SDK自己评估了】
    - 确保能够通过编译，同时能够通过厂家提供的所有硬件的测试案例
  - 最后是一个终极任务，也是比较好玩的任务
    - 移植 uniproton 的系统组件，跑uniproton的如shell 等之类的组件 或者 移植 uniproton 的应用组件，跑一些可见的效果，或者移植并跑官方的组件，比如很有可能会有AI相关的应用组件等之类的案例。



## 完成任务，准备提交上游

- 完成所有任务后，整理自己的代码，修改低质量的临时代码，准备提交对应pr 到上游仓库
- 截图自己跑 kernel api 测试案例的截图， 跑 rhealstone 测试案例的截图，跑官方驱动测试案例的截图，跑应用组件测试案例的截图，发送给board_support 模块的维护者